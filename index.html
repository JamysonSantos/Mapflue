<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mapflue — Texto para BPMN</title>
  <style>
    body { font-family: sans-serif; margin: 0; padding: 0; }
    header { background: #0097a7; color: white; padding: 1rem; text-align: center; }
    .container { display: flex; flex-wrap: wrap; padding: 1rem; gap: 1rem; justify-content: center; }
    textarea { width: 400px; height: 300px; padding: 1rem; border-radius: 8px; font-size: 1rem; }
    #canvas { width: 100%; height: 500px; border: 1px solid #ccc; min-width: 700px; }
    button { margin-top: 1rem; padding: 0.75rem 1.5rem; background: #0097a7; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; }
  </style>
  <link rel="stylesheet" href="https://unpkg.com/bpmn-js@10.3.0/dist/assets/diagram-js.css">
  <link rel="stylesheet" href="https://unpkg.com/bpmn-js@10.3.0/dist/assets/bpmn-font/css/bpmn-embedded.css">
</head>
<body>
  <header>
    <h1>Mapflue</h1>
    <p>Digite seu processo e veja o fluxo em BPMN</p>
  </header>
  <div class="container">
    <div>
      <textarea id="text-input" placeholder="T1: Medir porção de café\nT2: Esquentar água\nT3: Misturar café e água"></textarea>
      <br>
      <button onclick="gerarFluxo()">Gerar Fluxograma</button>
    </div>
    <div id="canvas"></div>
  </div>
  <script src="https://unpkg.com/bpmn-js@10.3.0/dist/bpmn-modeler.development.js"></script>
  <script>
    const modeler = new BpmnJS({ container: '#canvas' });

    async function gerarFluxo() {
      await modeler.createDiagram();
      const modeling = modeler.get('modeling');
      const elementFactory = modeler.get('elementFactory');
      const canvas = modeler.get('canvas');

      const input = document.getElementById("text-input").value.trim().split("\n").filter(l => l);

      if (input.length === 0) return;

      const elements = [];
      let x = 100, y = 200;

      const startEvent = modeling.createShape(
        elementFactory.createShape({ type: 'bpmn:StartEvent' }),
        { x, y },
        canvas.getRootElement()
      );

      elements.push(startEvent);

      for (let i = 0; i < input.length; i++) {
        x += 150;
        const task = modeling.createShape(
          elementFactory.createShape({ type: 'bpmn:Task', businessObject: { name: input[i] } }),
          { x, y },
          canvas.getRootElement()
        );
        modeling.createConnection(elements[i], task, {
          type: 'bpmn:SequenceFlow'
        });
        elements.push(task);
      }

      x += 150;
      const endEvent = modeling.createShape(
        elementFactory.createShape({ type: 'bpmn:EndEvent' }),
        { x, y },
        canvas.getRootElement()
      );

      modeling.createConnection(elements[elements.length - 1], endEvent, {
        type: 'bpmn:SequenceFlow'
      });

      canvas.zoom('fit-viewport');
    }
  </script>
</body>
</html>




